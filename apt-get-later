#!/bin/bash
# version 0.1
if [ ! -d partial ]
then
	mkdir partial && echo "Created necessary ./partial directory." || { echo Couldn\'t create ./partial directory. Exiting ; exit 1 ; } 
fi
p="`pwd`"
if apt-get -qq --print-uris $@ >uris
then
	while read a b d
	do	echo "wget -O $b $a"
	done <uris >wget_script
	echo "echo make sure you copy all these debs to $p on the machine you want to install them on." >>wget_script


	{	echo "apt-get -o dir::cache::archives=\"$p\" \`<apt-get-now-list\`" 
		echo "mv apt-get-now apt-get-now-old -f" 
		echo "mv apt-get-now-list apt-get-list-old -f" 
	} >>apt-get-now
	echo "$@" >>apt-get-now-list
	
	echo "wget_script written. "
	echo "1. Copy this to the machine that has network access."
	echo "2. Run it to fetch the .debs"
	echo "3. Copy the .debs back to $p on this machine."
	echo "4. Source"
	echo "   $ . apt-get-now"
	echo "   To do the installation."
	echo "5. You can then remove the debs from the networked machine, "
	echo "   along with the wget_script. And you can remove the apt-get-now script."
EOF
fi
rm -f uris
