#!/bin/bash
# runs smbmount on what you provide
function mountit {
if smbclient -L shinyblue -N 2>&1 1>/dev/null | grep Samba >/dev/null
then
	# samba server, mount as guest
	echo Samba server
	if smbmount $1 $2 -oguest,rw
	then return 0
	else return 1
	fi

else
	# windows, mount as Administrator with no password
	if smbmount $1 $2 -ousername=administrator,password=,rw
	then return 0
	else return 1
	fi
fi

}

mount=''
mnt=`grep "/home/rich/mnt " /proc/mounts | cut -f1-2 -d" "`
if [ -n "$mnt" ]
then 
	echo Existing mount: $mnt
	mount='2'
	mnt=`grep "/home/rich/mnt2 " /proc/mounts | cut -f1-2 -d" "`
	if [ -n "$mnt" ]
	then echo Existing mount: $mnt
		echo **cannot mount, both mount points in use
		exit 1
	fi
fi
if mountit $1 /home/rich/mnt$mount
then 
	echo "$1 mounted successfully on /home/rich/mnt$mount"
	newname=${1//\//-}
	ln -s /home/rich/mnt$mount /home/rich/Desktop/mnt-$newname
else echo **Mounting $1 failed.
	rm -f /home/rich/Desktop/$mount
fi

