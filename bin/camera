#!/bin/bash
name="$1"
MOUNTPT="/mnt/camera"
if [ -z "$name" ]
then	echo Usage: camera newdirectoryname
	exit 1
fi

fileno=1

if [ -e "$name" ]
then
	while [ -e "${name}_${fileno}" ]
	do	fileno=$(( $fileno + 1 ))
	done
	echo $name exists, using ${name}_${fileno}
	name="${name}_${fileno}"
fi


if mount $MOUNTPT
then :
else 	echo "Couldn't get camera." >&2
	exit 1
fi

mkdir "$name"
mv $MOUNTPT/dcim/100_fuji/* "$name"/. -f
umount $MOUNTPT
chmod 777 "$name"
chmod a+rw "${name}/"*
exit 0

